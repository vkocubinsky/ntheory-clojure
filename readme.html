<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-03-20 Wed 16:36 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Number theory with Clojure</title>
<meta name="author" content="Valery Kocubinsky" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Number theory with Clojure</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgf76fe1a">1. About</a></li>
<li><a href="#orga9a8209">2. Notation</a></li>
<li><a href="#org76651b4">3. Some basic functions</a>
<ul>
<li><a href="#org9fb9810">3.1. Power function</a></li>
<li><a href="#org2964e40">3.2. Sign function</a></li>
<li><a href="#org49bec41">3.3. Order function</a></li>
<li><a href="#org35a997b">3.4. The greatest common divisor</a></li>
</ul>
</li>
<li><a href="#org18a707c">4. Performance and cache</a></li>
<li><a href="#orga884490">5. Primes</a></li>
<li><a href="#orgfbef49f">6. Integer factorization</a></li>
<li><a href="#org829cda7">7. Divisors</a></li>
<li><a href="#org5ee8ce7">8. Arithmetical functions</a>
<ul>
<li><a href="#org879a8f2">8.1. Function equality</a></li>
<li><a href="#org8351186">8.2. Additive functions</a></li>
<li><a href="#org1e29db6">8.3. Multiplicative functions</a></li>
<li><a href="#org103abab">8.4. Higher order function for define multiplicative and additive functions</a></li>
<li><a href="#org933ea32">8.5. Some additive functions</a>
<ul>
<li><a href="#orge048aeb">8.5.1. Count of distinct primes - \(\omega\)</a></li>
<li><a href="#org78d5804">8.5.2. Total count of primes - \(\Omega\)</a></li>
</ul>
</li>
<li><a href="#org755ac04">8.6. Some multiplicative functions</a>
<ul>
<li><a href="#orgb26862c">8.6.1. Mobius function - \(\mu\).</a></li>
<li><a href="#org8efcc5d">8.6.2. Euler totient function - \(\phi\)</a></li>
<li><a href="#orgee67a8f">8.6.3. Unit function - \(\epsilon\)</a></li>
<li><a href="#org2a44e5d">8.6.4. Constant one function - \(1\)</a></li>
<li><a href="#org08c6cb9">8.6.5. Divisors count - \(\sigma_0\)</a></li>
<li><a href="#orgf3a2079">8.6.6. Divisors sum - \(\sigma_1\)</a></li>
<li><a href="#org279a08d">8.6.7. Divisors square sum</a></li>
<li><a href="#orgc739168">8.6.8. Divisors higher order function - \(\sigma_{x}\)</a></li>
<li><a href="#org53c6b85">8.6.9. Liouville - \(\lambda\)</a></li>
</ul>
</li>
<li><a href="#orgbe02d1f">8.7. Some other arithmetic functions</a>
<ul>
<li><a href="#org6ac4dd3">8.7.1. Mangoldt - \(\Lambda\)</a></li>
<li><a href="#org0b70ce0">8.7.2. Chebyshev functions \(\theta\) and \(\psi\)</a></li>
</ul>
</li>
<li><a href="#org7bc89e4">8.8. Dirichlet convolution</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgf76fe1a" class="outline-2">
<h2 id="orgf76fe1a"><span class="section-number-2">1.</span> About</h2>
<div class="outline-text-2" id="text-1">
<p>
This project cover some topics in number theory, especially arithmetic
functions, further more multiplicative functions. There are set of
well known arithmetic functions and one can define custom arithmetic
functions.
</p>

<p>
I wrote this document <code>readme.org</code> with Emacs Org Mode. Then I
generate markdown file <code>readme.md</code> with Org Mode export to markdown
<code>C-c C-e m m</code>, and generate pdf file <code>readme.odf</code> with Org Mode export
to pdf <code>C-c C-e l p</code>.  Github by default show <code>readme.md</code> if a project
has such file.  It looks enough good, even math equation is
supported. But I see some issue with greek characters in table of
content. If it is a problem <code>readme.pdf</code> looks better. Emacs file
"make.el" can be used to export markdown and pdf with one call. I use
Emacs babel for clojure to produce real output inside the document.
</p>

<p>
In this document I load number theory packages as: 
</p>

<div class="org-src-container">
<pre class="src src-clojure">(require '[vk.ntheory.basic :as b])
(require '[vk.ntheory.primes :as p])
(require '[vk.ntheory.ar-func :as f])
(require '[vk.ntheory.congruence :as c])
(require '[clojure.math :as math])
</pre>
</div>

<p>
So below I will use above aliases.
</p>
</div>
</div>

<div id="outline-container-orga9a8209" class="outline-2">
<h2 id="orga9a8209"><span class="section-number-2">2.</span> Notation</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>\(\mathbf N\) - Natural numbers, positive integers \(1,2,3,\dots\)</li>
<li>\(\mathbf C\) - Complex numbers</li>
<li>\(\mathbf Z\) - Integers \(\dots -3, -2, -1, 0, 1, 2, 3, \dots\)</li>
</ul>
</div>
</div>

<div id="outline-container-org76651b4" class="outline-2">
<h2 id="org76651b4"><span class="section-number-2">3.</span> Some basic functions</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org9fb9810" class="outline-3">
<h3 id="org9fb9810"><span class="section-number-3">3.1.</span> Power function</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Clojure has built-in <code>clojure.math/pow</code> function, but it return
<code>java.lang.Double</code>. The library provide integer analog
</p>

<div class="org-src-container">
<pre class="src src-clojure">(b/pow 2 3)
</pre>
</div>

<pre class="example">
8

</pre>
</div>
</div>

<div id="outline-container-org2964e40" class="outline-3">
<h3 id="org2964e40"><span class="section-number-3">3.2.</span> Sign function</h3>
<div class="outline-text-3" id="text-3-2">
<div class="org-src-container">
<pre class="src src-clojure">(mapv b/sign [(- 5) 10 0])
</pre>
</div>

<pre class="example">
[-1 1 0]

</pre>
</div>
</div>

<div id="outline-container-org49bec41" class="outline-3">
<h3 id="org49bec41"><span class="section-number-3">3.3.</span> Order function</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Order function \(ord_p(n)\) is a greatest power of \(p\) divides \(n\)
</p>

<div class="org-src-container">
<pre class="src src-clojure">(b/order 2 24)
</pre>
</div>

<pre class="example">
3

</pre>
</div>
</div>

<div id="outline-container-org35a997b" class="outline-3">
<h3 id="org35a997b"><span class="section-number-3">3.4.</span> The greatest common divisor</h3>
<div class="outline-text-3" id="text-3-4">
<p>
The greatest common divisor of two integer \(a\) and \(b\) is an positive
integer \(d\) which divide \(a\) and \(b\) and any other common divisor <code>a</code>
and \(b\) divides \(d\).
</p>

<div class="org-src-container">
<pre class="src src-clojure">(b/gcd 12 18)
</pre>
</div>

<pre class="example">
6

</pre>


<p>
For convenience <code>(gcd 0 0)</code> is <code>0</code>.
</p>

<p>
Furthermore, if for any two integers \(a\) and \(b\) exists integers <code>s</code>
and \(t\) such that \(a s + b t = d\) , where d is the greatest common
divisor. For example, \(6 = 12 (-1) + 18 (1)\)
</p>

<div class="org-src-container">
<pre class="src src-clojure">(b/gcd-extended 12 18)
</pre>
</div>

<pre class="example">
[6 -1 1]

</pre>
</div>
</div>
</div>

<div id="outline-container-org18a707c" class="outline-2">
<h2 id="org18a707c"><span class="section-number-2">4.</span> Performance and cache</h2>
<div class="outline-text-2" id="text-4">
<p>
This library is designed to work with realtive small integers. Library
keep in cache least prime divisor table for fast integer
factorization.  Cache grows automatically. The strategy of growing is
extends cache to the least power of <code>10</code> more than required
number. For instance, if client asked to factorize number <code>18</code>, cache
grows to <code>100</code>, if client asked to factorize number <code>343</code>, cache grows
to <code>1000</code>. List of primes also cached and recalculated together
with least prime divisor table. Recalculation is not incremental, but
every recalculation of least prime divisor table make a table which is
in <code>10</code> times more than previous, and time for previous calculation is
<code>10</code> times less than for new one. So we can say that recalculation
spent almost all time for recalculate latest least prime divisor
table.
</p>

<p>
Internally, least prime divisor table is java array of int, so to store
least divisor table for first <code>1 000 000</code> number approximately <code>4M</code>
memory is required, <code>4</code> bytes per number.
</p>

<p>
Cache can be reset:
</p>

<div class="org-src-container">
<pre class="src src-clojure">(p/cache-reset!)
</pre>
</div>

<pre class="example">
{:least-divisor-table , :primes , :upper 0}

</pre>


<p>
Least prime divisor table is implementation details, but one can see
it:
</p>

<div class="org-src-container">
<pre class="src src-clojure">;; load first 10 numbers into cache
(p/int-&gt;factors-map 5)
</pre>
</div>

<pre class="example">
{5 1}

</pre>




<p>
For instance, for get least prime divisor of number 6 we need to get
element with index 6, which is 2. Index zero is not used, value for
index 1 is 1.
</p>
</div>
</div>

<div id="outline-container-orga884490" class="outline-2">
<h2 id="orga884490"><span class="section-number-2">5.</span> Primes</h2>
<div class="outline-text-2" id="text-5">
<p>
<code>primes</code> function returns prime numbers which not exceeds given <code>n</code>.
</p>

<div class="org-src-container">
<pre class="src src-clojure">(p/primes 30)
</pre>
</div>

<pre class="example">
(2 3 5 7 11 13 17 19 23 29)

</pre>
</div>
</div>

<div id="outline-container-orgfbef49f" class="outline-2">
<h2 id="orgfbef49f"><span class="section-number-2">6.</span> Integer factorization</h2>
<div class="outline-text-2" id="text-6">
<p>
Every integer more than \(1\) can be represented uniquely as a product
of primes.
</p>


<p>
\[
n = {p_1}^{a_1} {p_2}^{a_2} \dots {p_k}^{a_k}
\]
</p>

<p>
or we can write it in more compact form:
</p>

<p>
\[
n = \prod_{i=1}^{k} {p_i}^{a_i}
\]
</p>

<p>
or even write as:
</p>

<p>
\[n = \prod_{p|n} p^a\]
</p>


<p>
If we accept that empty product is \(1\) we can say that every natural
number can be represent uniquely as a product of primes. For example
\(360 = 2^3 3^2 5^1\).
</p>

<p>
There are some functions to factorize integers. Each of them accept
natural number as an argument and returns factorized value. It have
slightly different output, which may be more appropriate to different
use cases. For each factorize function there is also inverse function,
which accept factorized value and convert it back to integer.
</p>

<p>
1-st factorization representation is ordered sequence of primes:
</p>

<div class="org-src-container">
<pre class="src src-clojure">(p/int-&gt;factors 360)
</pre>
</div>

<pre class="example">
(2 2 2 3 3 5)

</pre>


<div class="org-src-container">
<pre class="src src-clojure">(p/factors-&gt;int [2 2 2 3 3 5])
</pre>
</div>

<pre class="example">
360

</pre>


<p>
2-nd factorization representation is ordered sequence of primes
splited by partitions by a prime:
</p>

<div class="org-src-container">
<pre class="src src-clojure">(p/int-&gt;factors-partitions 360)
</pre>
</div>

<pre class="example">
((2 2 2) (3 3) (5))

</pre>


<div class="org-src-container">
<pre class="src src-clojure">(p/factors-partitions-&gt;int [[2 2 2] [3 3] [5]])
</pre>
</div>

<pre class="example">
360

</pre>


<p>
3-rd factorization representation is ordered sequence of pairs <code>[p
k]</code>, where <code>p</code> is a prime and <code>k</code> is a power of prime
</p>

<div class="org-src-container">
<pre class="src src-clojure">(p/int-&gt;factors-count 360)
</pre>
</div>

<pre class="example">
([2 3] [3 2] [5 1])

</pre>


<div class="org-src-container">
<pre class="src src-clojure">(p/factors-count-&gt;int [[2 3] [3 2] [5 1]])
</pre>
</div>

<pre class="example">
360

</pre>


<p>
4-th factorization representation is very similar to 3-rd, but it
is a map. And it has the same inverse function as 3-rd.
</p>

<div class="org-src-container">
<pre class="src src-clojure">(p/int-&gt;factors-map 360)
</pre>
</div>

<pre class="example">
{2 3, 3 2, 5 1}

</pre>


<div class="org-src-container">
<pre class="src src-clojure">(p/factors-count-&gt;int {2 3, 3 2, 5 1})
</pre>
</div>

<pre class="example">
360

</pre>


<p>
Implementation of factorization use least prime divisor table. To
factorize number <code>n</code> it is enough to calculate least divisor table
with size less or equals to \(\sqrt n\). 
</p>
</div>
</div>

<div id="outline-container-org829cda7" class="outline-2">
<h2 id="org829cda7"><span class="section-number-2">7.</span> Divisors</h2>
<div class="outline-text-2" id="text-7">
<p>
For get list of all divisors of number <code>n</code> there is <code>divisor</code>
function. List of divisors is unordered.
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/divisors 30)
</pre>
</div>

<pre class="example">
(1 2 3 6 5 10 15 30)

</pre>
</div>
</div>

<div id="outline-container-org5ee8ce7" class="outline-2">
<h2 id="org5ee8ce7"><span class="section-number-2">8.</span> Arithmetical functions</h2>
<div class="outline-text-2" id="text-8">
<p>
Arithmetical function is an any function which accept natural number
and return complex number \(f: \mathbf N \to \mathbf C\). The library mostly works
with functions which also returns integer \(f: \mathbf N \to \mathbf Z\).
</p>
</div>

<div id="outline-container-org879a8f2" class="outline-3">
<h3 id="org879a8f2"><span class="section-number-3">8.1.</span> Function equality</h3>
<div class="outline-text-3" id="text-8-1">
<p>
Two arithmetical function \(f\) and \(g\) are equal if \(f(n)=g(n)\) for all
natual \(n\). There is helper function <code>f-equlas</code> which compare two
functions on some sequence of natual numbers. Function <code>f-equals</code>
accept two functions and optionally sequence of natural numbers. There
is a default for sequence of natural numbers, it is a variable
<code>default-natural-sample</code>, which is currently <code>range(1,100)</code>.
</p>

<p>
If we like identify does two function <code>f</code> and <code>g</code> equals on some
sequence of natural number we can for example do next:
</p>

<div class="org-src-container">
<pre class="src src-clojure">;; Let we have some f and g
(def f identity)
(def g (constantly 1))
;; Then we able to check does those functions are equals
(f/f-equals f g)
(f/f-equals f g (range 1 1000))
(f/f-equals f g (filter even? (range 1 100)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org8351186" class="outline-3">
<h3 id="org8351186"><span class="section-number-3">8.2.</span> Additive functions</h3>
<div class="outline-text-3" id="text-8-2">
<p>
Additive function is a function for which
</p>

<p>
\[ f(mn) = f(m) + f(n)\]
</p>

<p>
if \(m\) relatively prime to \(n\). If above equality holds for all
natural \(m\) and \(n\) function called completely additive.
</p>

<p>
To define an additive function it is enough to define how to
calculate a function on power of primes.
If \(n = p_1^{a_1} p_2^{a_2} \dots p_k^{a_k}\) then: 
</p>

<p>
\[ f(n) = \sum_{i=1}^{k} f({p_i}^{a_i}) \]
</p>
</div>
</div>

<div id="outline-container-org1e29db6" class="outline-3">
<h3 id="org1e29db6"><span class="section-number-3">8.3.</span> Multiplicative functions</h3>
<div class="outline-text-3" id="text-8-3">
<p>
Multiplicative function is a function not equal to zero for all n
for which 
</p>

<p>
\[ f(mn) = f(m)f(n) \]
</p>

<p>
if \(m\) relatively prime to \(n\). If above equality holds for all
natural \(m\) and \(n\) function called completely multiplicative.
</p>

<p>
To define multiplicative function it is enough to define how to
calculate a function on power of primes. If \(n = p_1^{a_1} p_2^{a_2}
\dots p_k^{a_k}\) then:
</p>

<p>
\[ f(n) = \prod_{i=1}^{k} f({p_i}^{a_i}) \]
</p>
</div>
</div>

<div id="outline-container-org103abab" class="outline-3">
<h3 id="org103abab"><span class="section-number-3">8.4.</span> Higher order function for define multiplicative and additive functions</h3>
<div class="outline-text-3" id="text-8-4">
<p>
As we have seen, to define either multiplicative or additive function
it is enough define function on power of a prime.  There is helper
function <code>reduce-on-prime-count</code> which provide a way to define a
function on power of a prime. The first parameter of
<code>reduce-on-prime-count</code> is reduce function which usually <code>*</code> for
multiplicative function and usually <code>+</code> for additive function, but
custom reduce function also acceptable.
</p>

<p>
For instance, we can define function which calculate number of
divisors of integer <code>n</code>. If \(n = p_1^{a_1} p_2^{a_2} \dots p_k^{a_k}\) count of divisors of
number <code>n</code> can be calculated by formula:
</p>

<p>
\[ \sigma_0(n) = \prod_{i=1}^{k} (a_i + 1) \]
</p>

<p>
With helper function it can be defined as
</p>

<div class="org-src-container">
<pre class="src src-clojure">(def my-divisors-count
(f/reduce-on-prime-count * (fn [p k] (inc k))))
(my-divisors-count 6)
</pre>
</div>

<pre class="example">
4

</pre>


<p>
Of course there is predefined function <code>divisors-count</code>, but it
is an example how to define custom function.
</p>
</div>
</div>

<div id="outline-container-org933ea32" class="outline-3">
<h3 id="org933ea32"><span class="section-number-3">8.5.</span> Some additive functions</h3>
<div class="outline-text-3" id="text-8-5">
</div>
<div id="outline-container-orge048aeb" class="outline-4">
<h4 id="orge048aeb"><span class="section-number-4">8.5.1.</span> Count of distinct primes - \(\omega\)</h4>
<div class="outline-text-4" id="text-8-5-1">
<p>
Count of distinct primes is a number of distinct primes which
divides given \(n\). If \(n = p_1^{a_1} p_2^{a_2} \dots p_k^{a_k}\) then \(\omega = k\).
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/primes-count-distinct (* 2 2 3))
</pre>
</div>

<pre class="example">
2

</pre>
</div>
</div>

<div id="outline-container-org78d5804" class="outline-4">
<h4 id="org78d5804"><span class="section-number-4">8.5.2.</span> Total count of primes - \(\Omega\)</h4>
<div class="outline-text-4" id="text-8-5-2">
<p>
Total count of primes is a number of primes and power of primes
which divides \(n\). If \(n = p_1^{a_1} p_2^{a_2} \dots p_k^{a_k}\) then:
</p>

<p>
\[\Omega = a_1 + a_2 + \dots + a_k\]
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/primes-count-total (* 2 2 3))
</pre>
</div>

<pre class="example">
3

</pre>
</div>
</div>
</div>

<div id="outline-container-org755ac04" class="outline-3">
<h3 id="org755ac04"><span class="section-number-3">8.6.</span> Some multiplicative functions</h3>
<div class="outline-text-3" id="text-8-6">
</div>
<div id="outline-container-orgb26862c" class="outline-4">
<h4 id="orgb26862c"><span class="section-number-4">8.6.1.</span> Mobius function - \(\mu\).</h4>
<div class="outline-text-4" id="text-8-6-1">
<p>
Mobius function defined as:
</p>


<p>
\[ \mu(n) = \begin{cases}
1        &  \quad \text{if } n = 1 \\
(-1)^k   &  \quad \text{if } n \text{ product of distinct primes} \\
0        &  \quad \text{otherwise}
\end{cases} \]
</p>

<p>
For example, \(\mu(6)=\mu(2 \cdot 3)=1\)
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/mobius 6)
</pre>
</div>

<pre class="example">
1

</pre>
</div>
</div>

<div id="outline-container-org8efcc5d" class="outline-4">
<h4 id="org8efcc5d"><span class="section-number-4">8.6.2.</span> Euler totient function - \(\phi\)</h4>
<div class="outline-text-4" id="text-8-6-2">
<p>
Euler totient function  is a count of numbers relative  prime to given
number <code>n</code>.  Totient function can be calculated by formula:
</p>


<p>
\[ \phi(n) = \prod_{p|n} (p^a - p^{a-1}) \]
</p>

<p>
For example, count of numbers relative prime to \(6\) are \(1\) and \(5\), so \(\phi(6) = 2\)
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/totient 6)
</pre>
</div>

<pre class="example">
2

</pre>
</div>
</div>

<div id="outline-container-orgee67a8f" class="outline-4">
<h4 id="orgee67a8f"><span class="section-number-4">8.6.3.</span> Unit function - \(\epsilon\)</h4>
<div class="outline-text-4" id="text-8-6-3">
<p>
Unit function defined as
</p>

<p>
\[ \epsilon(n) = \begin{cases}
1,&  \text{if } n = 1 \\
0,&  \text{if } n > 1
\end{cases} \]
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/unit 6)
</pre>
</div>

<pre class="example">
0

</pre>
</div>
</div>

<div id="outline-container-org2a44e5d" class="outline-4">
<h4 id="org2a44e5d"><span class="section-number-4">8.6.4.</span> Constant one function - \(1\)</h4>
<div class="outline-text-4" id="text-8-6-4">
<p>
\[ 1(n) = 1 \]
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/one 6)
</pre>
</div>

<pre class="example">
1

</pre>
</div>
</div>

<div id="outline-container-org08c6cb9" class="outline-4">
<h4 id="org08c6cb9"><span class="section-number-4">8.6.5.</span> Divisors count - \(\sigma_0\)</h4>
<div class="outline-text-4" id="text-8-6-5">
<p>
Divisors count is number of divisors which divides given number \(n\).
</p>

<p>
\[ \sigma_0(n) = \sum_{d|n} 1 \]
</p>

<p>
For example, number \(64\) has \(4\) divisors, namely \(1,2,3,6\), so \(\sigma_0(6)=4\)
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/divisors-count 6)
</pre>
</div>

<pre class="example">
4

</pre>
</div>
</div>

<div id="outline-container-orgf3a2079" class="outline-4">
<h4 id="orgf3a2079"><span class="section-number-4">8.6.6.</span> Divisors sum - \(\sigma_1\)</h4>
<div class="outline-text-4" id="text-8-6-6">
<p>
\[ \sigma_1(n) = \sum_{d | n} d \]
</p>

<p>
For number 6 it is \(12 = 1 + 2 + 3 + 6\)
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/divisors-sum 6)
</pre>
</div>

<pre class="example">
12

</pre>
</div>
</div>

<div id="outline-container-org279a08d" class="outline-4">
<h4 id="org279a08d"><span class="section-number-4">8.6.7.</span> Divisors square sum</h4>
<div class="outline-text-4" id="text-8-6-7">
<p>
\[ \sigma_2(n) = \sum_{d | n} d^2 \]
</p>

<p>
For number 6 it is \(50 = 1^2 + 2^2 + 3^2 + 6^2\)
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/divisors-square-sum 6)
</pre>
</div>

<pre class="example">
50

</pre>
</div>
</div>

<div id="outline-container-orgc739168" class="outline-4">
<h4 id="orgc739168"><span class="section-number-4">8.6.8.</span> Divisors higher order function - \(\sigma_{x}\)</h4>
<div class="outline-text-4" id="text-8-6-8">
<p>
In general \(\sigma_x\) function is a sum of x-th powers divisors of given n
</p>

<p>
\[ \sigma_x(n) = \sum_{ d | n} d^x \]
</p>

<p>
If \(x \ne 0\) \(\sigma_x\) can be calculated by formula:
</p>

<p>
\[ \sigma_{x}(n) = \prod_{i=1}^{k} \frac {p_i^{(a_i+1)x}} {p_i^x - 1} \]
</p>

<p>
and if \(x = 0\) by formula:
</p>

<p>
\[ \sigma_{0}(n) = \prod_{i=1}^{k} (a_i + 1) \]
</p>

<p>
There is higher order function <code>divisors-sum-x</code> which
accept <code>x</code> and return appropriate function.
</p>

<div class="org-src-container">
<pre class="src src-clojure">(def my-divisors-square-sum (f/divisors-sum-x 2))
</pre>
</div>
</div>
</div>

<div id="outline-container-org53c6b85" class="outline-4">
<h4 id="org53c6b85"><span class="section-number-4">8.6.9.</span> Liouville - \(\lambda\)</h4>
<div class="outline-text-4" id="text-8-6-9">
<p>
Liouville function can be defind by formula:
</p>

<p>
\[\lambda(n) = (-1)^{\Omega(n)}\]
</p>

<p>
where <a href="#org78d5804">\(\Omega\)</a> have been descibed above.
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/liouville (* 2 3)) 
</pre>
</div>

<pre class="example">
1

</pre>
</div>
</div>
</div>

<div id="outline-container-orgbe02d1f" class="outline-3">
<h3 id="orgbe02d1f"><span class="section-number-3">8.7.</span> Some other arithmetic functions</h3>
<div class="outline-text-3" id="text-8-7">
</div>
<div id="outline-container-org6ac4dd3" class="outline-4">
<h4 id="org6ac4dd3"><span class="section-number-4">8.7.1.</span> Mangoldt - \(\Lambda\)</h4>
<div class="outline-text-4" id="text-8-7-1">
<p>
\[\Lambda(n) = \begin{cases}
   \log p,& \text{if $n$ is power of prime i.e. $n = p^k$} \\
   0,& \text{otherwise} 
\end{cases}\]
</p>

<p>
For example \(\Lambda(8) = \log 2\), \(\Lambda(6) = 0\)  
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/mangoldt 2)
</pre>
</div>

<pre class="example">
0.6931471805599453

</pre>


<div class="org-src-container">
<pre class="src src-clojure">(f/mangoldt 6)
</pre>
</div>

<pre class="example">
0

</pre>
</div>
</div>

<div id="outline-container-org0b70ce0" class="outline-4">
<h4 id="org0b70ce0"><span class="section-number-4">8.7.2.</span> Chebyshev functions \(\theta\) and \(\psi\)</h4>
<div class="outline-text-4" id="text-8-7-2">
<p>
There are two Chebyshev functions, one \(\theta\) is defined as
</p>

<p>
\[\theta(x) = \sum_{p \le x} \log p\]
</p>

<p>
second \(\psi\) defined as
</p>

<p>
\[\psi = \sum_{n \le x} {\Lambda(n)} \]
</p>

<p>
where <a href="#org6ac4dd3">\(\Lambda\)</a> have been described above
</p>


<div class="org-src-container">
<pre class="src src-clojure">(f/chebyshev-first 2)
</pre>
</div>

<pre class="example">
0.6931471805599453

</pre>


<div class="org-src-container">
<pre class="src src-clojure">(f/chebyshev-second 2)
</pre>
</div>

<pre class="example">
0.6931471805599453

</pre>
</div>
</div>
</div>

<div id="outline-container-org7bc89e4" class="outline-3">
<h3 id="org7bc89e4"><span class="section-number-3">8.8.</span> Dirichlet convolution</h3>
<div class="outline-text-3" id="text-8-8">
<p>
For two arithmetic functions \(f\) and \(g\) Dirichlet convolution is a
new arithmetic function defined as
</p>

<p>
\[ (f*g)(n) = \sum_{d | n} f(d)g(\frac{n}{d}) \]
</p>

<p>
Dirichlet convolution is associative
</p>

<p>
\[ (f * g) * h = f * (g * h) \]
</p>

<p>
Commutative
</p>

<p>
\[ f * g = g * f \]
</p>

<p>
Has identify
</p>

<p>
\[ f * \epsilon = \epsilon * f = f \]
</p>

<p>
For every \(f\), which \(f(1) \ne 0\) exists inverse function \(f^{-1}\)
such that \(f * f^{-1} = \epsilon\). This inverse function called
Dirichlet inverse and can by calculated recursively by formula:
</p>

<p>
\[ f^{-1}(n) = \begin{cases}
\frac{1}{f(1)} & \quad \text{if } n = 1  \\
\frac{-1}{f(1)}\sum_{ \substack{d | n\\
                                d < n}} f(\frac{n}{d}) f^{-1}(d)
               & \quad n \ge 1
\end{cases} \]
</p>


<p>
For example, \(1(n) * 1(n) = \sigma_0\)
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/f-equals
   (f/d-* f/one f/one)
   f/divisors-count
)
</pre>
</div>

<pre class="example">
class clojure.lang.Compiler$CompilerException
</pre>


<p>
Dirichlet convolution is associative so clojure method support more than two
function as parameter of <code>f*</code>
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/f-equals
  (f/d-* f/mobius f/one f/mobius f/one)
  f/unit
)
</pre>
</div>

<pre class="example">
class clojure.lang.Compiler$CompilerException
</pre>


<p>
Another example, functions \(\mu(n)\) and \(1(n)\) are inverse of each other
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/f-equals (f/d-inv f/one) f/mobius)
</pre>
</div>

<pre class="example">
class clojure.lang.Compiler$CompilerException
</pre>


<div class="org-src-container">
<pre class="src src-clojure">(f/f-equals (f/d-inv f/mobius) f/one)
</pre>
</div>

<pre class="example">
class clojure.lang.Compiler$CompilerException
</pre>



<p>
Function <code>d-inv</code> defined as recursive function, it may
execute slow. But inverse of completely multiplicative function \(f(n)\)
is \(f(n) \mu(n)\)(usual multiplication), for instance inverse
of identity function, let's denote it \(N(n)\) is \(N(n) \mu(n)\)
</p>

<div class="org-src-container">
<pre class="src src-clojure">(f/f-equals
 (f/d-* 
    #(* (identity %) (f/mobius %))
    identity
 )
 f/unit)
</pre>
</div>

<pre class="example">
class clojure.lang.Compiler$CompilerException
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Valery Kocubinsky</p>
<p class="date">Created: 2024-03-20 Wed 16:36</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
